<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Avantage Construction</title>
    <link rel="stylesheet" href="styles.css" />
    <link
        href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Merriweather:wght@400;700&display=swap"
        rel="stylesheet" />
</head>

<body>
    <nav>
        <div class="container">
            <div class="logo">
                <a href="#home">
                    <img src="/img/logo.jpg" alt="ConstructionCo Logo" />
                </a>
            </div>
            <div class="menu-icon">
                <span class="hamburger-icon">&#9776;</span>
            </div>
            <div class="menu">
                <a href="#">Accueil</a>
                <a href="#gallery">Réalisations</a>
                <a href="#about">Notre mission</a>
                <a href="#contact">Contact</a>
                <!-- <a href="#" class="language-switcher">Français</a> -->
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-content">
            <h1>Avantage Construction</h1>
            <p>Jean-Marc Roy, Entrepreneur général</p>
        </div>
    </section>

    <!-- Gallery Section -->
    <section id="gallery" class="gallery">
        <div class="container">
            <h2>Réalisations</h2>
            <div class="gallery-links">
                <div class="gallery-item">
                    <a href="#" data-gallery="residential" class="gallery-link">
                        <div class="gallery-overlay">Résidentiel</div>
                        <img src="/img/residential-thumbnail.webp" alt="Résidentiel" />
                    </a>
                </div>
                <div class="gallery-item">
                    <a href="#" data-gallery="commercial" class="gallery-link">
                        <div class="gallery-overlay">Commercial</div>
                        <img src="/img/commercial-thumbnail.webp" alt="Commercial" />
                    </a>
                </div>
                <div class="gallery-item">
                    <a href="#" data-gallery="other" class="gallery-link">
                        <div class="gallery-overlay">Autres réalisations</div>
                        <img src="/img/autres-realisations-thumbnail.webp" alt="Autres réalisations" />
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about">
        <div class="container">
            <div class="about-content">
                <div class="about-text">
                    <h2>Notre mission</h2>
                    <p>
                        Chez Avantage Construction JMR Inc., notre mission est d'offrir à
                        nos clients des services de construction et de rénovation de
                        qualité qui vont répondre à leurs divers besoins.
                    </p>
                    <p>
                        Depuis plus de vingt ans, nous oeuvrons dans la construction
                        commerciale et résidentielle.
                    </p>
                    <p>
                        Nous travaillons ensemble avec nos clients pour assurer que leurs
                        projets soient réalisés à leur entière satisfaction.
                    </p>
                    <p>Jean-Marc Roy</p>
                    <p>Président</p>
                </div>
                <div class="about-image">
                    <img src="/img/mission.jpg" alt="Our Mission" />
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact">
        <div class="container">
            <div class="contact-info">
                <h2>Contactez-nous</h2>
                <p>1965, Av. Haig</p>
                <p>Montréal, Québec, H1N 3E1</p>
                <p>Jean-Marc Roy, Président</p>
                <p>514 913-3457</p>
                <p>Julie Harris, bureau</p>
                <p>438 777-1501</p>
                <p><a href="mailto:info@avantagejmr.com">info@avantagejmr.com</a></p>
            </div>
            <form id="contact-form" action="https://formspree.io/f/mvgplepr" method="post">
                <input type="text" name="_honeypot" style="display: none" />

                <div class="form-group">
                    <label for="name">Nom</label>
                    <input type="text" id="name" name="name" required />
                </div>
                <div class="form-group">
                    <label for="email">Courriel</label>
                    <input type="email" id="email" name="email" required />
                </div>
                <div class="form-group">
                    <label for="message">Message</label>
                    <textarea id="message" name="message" rows="5" required></textarea>
                </div>
                <button type="submit">Soumettre</button>
            </form>

            <div id="success-message" style="display: none">
                Merci pour votre message! Nous vous répondrons dès que possible.
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p style="font-size: smaller">
                RBQ 8314-7892-09<br />OPC 122515<br />APCHQ 918064-04
            </p>
            <p>&copy; 2024 Avantage Construction. Tous droits réservés.</p>
        </div>
    </footer>

    <script>
        // Lazy load function to set the actual image source
        function lazyLoadImage(image, src) {
            if (!image.src) {
                image.src = src;
            }
        }

        // Lazy loading observer
        function lazyLoadImages() {
            const images = document.querySelectorAll(".lazy-load");
            const options = {
                root: null, // Use the viewport as the container
                rootMargin: "0px",
                threshold: 0.1, // Image must be 10% visible before loading
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        const src = img.getAttribute("data-src");
                        lazyLoadImage(img, src);
                        observer.unobserve(img); // Stop observing after loading
                    }
                });
            }, options);

            images.forEach((image) => {
                observer.observe(image);
            });
        }

        // Call this function after the gallery is created
        lazyLoadImages();

        // Carousel Auto Movement
        const carouselImages = document.querySelector(".carousel-images");
        if (carouselImages) {
            let currentIndex = 0;

            function moveCarousel() {
                const items = document.querySelectorAll(".carousel-item");
                if (items.length > 0) {
                    currentIndex = (currentIndex + 1) % items.length;
                    const offset = -currentIndex * 100;
                    carouselImages.style.transform = `translateX(${offset}%)`;
                }
            }

            setInterval(moveCarousel, 3000); // Move carousel every 3 seconds
        } else {
            console.log("Carousel images not found.");
        }

        // Popup Gallery
        document.addEventListener("DOMContentLoaded", () => {
            console.log("DOM fully loaded and parsed");

            // Handle opening the gallery
            document.querySelectorAll(".gallery-link").forEach((link) => {
                link.addEventListener("click", function (e) {
                    e.preventDefault(); // Prevent default link behavior
                    const galleryType = this.dataset.gallery;
                    console.log(`Opening gallery for type: ${galleryType}`);
                    openGallery(galleryType);
                });
            });

            function openGallery(type) {
                console.log(`Creating gallery for type: ${type}`);
                const galleryContainer = document.createElement("div");
                galleryContainer.classList.add("gallery-popup");
                document.body.appendChild(galleryContainer);

                let galleryImages = [];
                switch (type) {
                    case "residential":
                        galleryImages = [
                            {
                                src: "/img/residential1.webp",
                                subtext: "RÉNOVATION ROSEMONT ➣ entrée, salon et cuisine",
                            },
                            { src: "/img/residential2.webp", subtext: "RÉNOVATION ROSEMONT ➣ entrée, salon et cuisine" },
                            { src: "/img/residential3.webp", subtext: "RÉNOVATION ROSEMONT ➣ entrée, salon et cuisine" },
                            { src: "/img/residential4.webp", subtext: "RÉNOVATION ROSEMONT ➣ entrée, salon et cuisine" },
                            { src: "/img/residential5.webp", subtext: "RÉNOVATION ROSEMONT ➣ entrée, salon et cuisine" },
                            { src: "/img/residential6.webp", subtext: "RÉNOVATION ROSEMONT ➣ entrée, salon et cuisine" },
                            { src: "/img/residential7.webp", subtext: "RÉNOVATION ROSEMONT ➣ entrée, salon et cuisine" },
                            { src: "/img/residential8.webp", subtext: "RÉNOVATION ROSEMONT ➣ entrée, salon et cuisine" },
                            { src: "/img/residential9.webp", subtext: "RÉNOVATION ROSEMONT ➣ entrée, salon et cuisine" },
                            { src: "/img/residential10.webp", subtext: "Rénovation Notre-Dame-de-Grâce ➣ cuisine" },
                            { src: "/img/residential11.webp", subtext: "Rénovation Notre-Dame-de-Grâce ➣ cuisine" },
                            { src: "/img/residential12.webp", subtext: "Rénovation Notre-Dame-de-Grâce ➣ cuisine" },
                            { src: "/img/residential13.webp", subtext: "Rénovation Notre-Dame-de-Grâce ➣ cuisine" },
                            { src: "/img/residential14.webp", subtext: "Rénovation Notre-Dame-de-Grâce ➣ cuisine" },
                            { src: "/img/residential15.webp", subtext: "Rénovation Brossard ➣ Cuisine et Salle de bain" },
                            { src: "/img/residential16.webp", subtext: "Rénovation Brossard ➣ Cuisine et Salle de bain" },
                            { src: "/img/residential17.webp", subtext: "Rénovation Brossard ➣ Cuisine et Salle de bain" },
                            { src: "/img/residential18.webp", subtext: "Rénovation Brossard ➣ Cuisine et Salle de bain" },
                            { src: "/img/residential19.webp", subtext: "Rénovation Brossard ➣ Cuisine et Salle de bain" },
                            { src: "/img/residential20.webp", subtext: "Rénovation Brossard ➣ Cuisine et Salle de bain" },
                            { src: "/img/residential21.webp", subtext: "Rénovation Brossard ➣ Sous-sol" },
                            { src: "/img/residential22.webp", subtext: "Rénovation Brossard ➣ Sous-sol" },
                            { src: "/img/residential23.webp", subtext: "Rénovation Brossard ➣ Sous-sol" },
                            { src: "/img/residential24.webp", subtext: "Rénovation Brossard ➣ Sous-sol" },
                            { src: "/img/residential25.webp", subtext: "Rénovation Brossard ➣ Sous-sol" },
                            { src: "/img/residential26.webp", subtext: "Rénovation Brossard ➣ Sous-sol" },
                        ];

                        break;
                    case "commercial":
                        galleryImages = [
                            {
                                src: "/img/commercial1.webp",
                                subtext: "Studio de Yoga, rue Molson à Montréal",
                            },
                            {
                                src: "/img/commercial2.webp",
                                subtext: "Studio de Yoga, rue Molson à Montréal",
                            },
                            { src: "/img/commercial3.webp", subtext: "Studio de Yoga, rue Molson à Montréal" },
                            { src: "/img/commercial4.webp", subtext: "Studio de Yoga, rue Molson à Montréal" },
                            { src: "/img/commercial5.webp", subtext: "Studio de Yoga, rue Molson à Montréal" },

                        ];
                        break;
                    case "other":
                        galleryImages = [
                            { src: "/img/other1.jpg", subtext: "Custom outdoor deck" },
                            { src: "/img/other2.jpg", subtext: "Bathroom tiling" },
                        ];
                        break;
                }

                galleryContainer.innerHTML = `
                <div class="gallery-content">
                    <span class="gallery-close">&times;</span>
                    <div class="gallery-scroll">
                        ${galleryImages
                        .map(
                            (image) => `
                                <div class="gallery-slide">
                                    <img src="${image.src}" alt="">
                                    <div class="gallery-subtext">${image.subtext}</div>
                                </div>
                            `
                        )
                        .join("")}
                    </div>
                    <button class="gallery-prev">&lt;</button>
                    <button class="gallery-next">&gt;</button>
                </div>
            `;

                const galleryScroll =
                    galleryContainer.querySelector(".gallery-scroll");
                const slides = galleryScroll.querySelectorAll(".gallery-slide");
                let currentIndex = 0;

                function updateGalleryPosition() {
                    console.log(`Updating gallery position to index: ${currentIndex}`);
                    const offset = -currentIndex * galleryScroll.clientWidth;
                    galleryScroll.style.transform = `translateX(${offset}px)`;
                }

                // Handle navigation buttons with looping
                galleryContainer
                    .querySelector(".gallery-next")
                    .addEventListener("click", () => {
                        console.log("Next button clicked");
                        currentIndex = (currentIndex + 1) % slides.length; // Loop around
                        updateGalleryPosition();
                    });

                galleryContainer
                    .querySelector(".gallery-prev")
                    .addEventListener("click", () => {
                        console.log("Previous button clicked");
                        currentIndex = (currentIndex - 1 + slides.length) % slides.length; // Loop around
                        updateGalleryPosition();
                    });

                // Handle swipe detection for mobile with looping
                let startX,
                    isSwiping = false;

                galleryScroll.addEventListener("touchstart", (e) => {
                    startX = e.touches[0].clientX;
                    isSwiping = true;
                    console.log("Touch start detected");
                });

                galleryScroll.addEventListener(
                    "touchmove",
                    (e) => {
                        if (!isSwiping) return;
                        const touchX = e.touches[0].clientX;
                        const deltaX = touchX - startX;

                        if (deltaX > 50) {
                            console.log("Swipe detected: moving to previous slide");
                            currentIndex =
                                (currentIndex - 1 + slides.length) % slides.length; // Loop around
                            updateGalleryPosition();
                            isSwiping = false;
                        } else if (deltaX < -50) {
                            console.log("Swipe detected: moving to next slide");
                            currentIndex = (currentIndex + 1) % slides.length; // Loop around
                            updateGalleryPosition();
                            isSwiping = false;
                        }
                    },
                    { passive: true }
                );

                // Ensure the "X" button works after touch events
                const closeButton = galleryContainer.querySelector(".gallery-close");

                closeButton.addEventListener("click", (e) => {
                    e.stopPropagation();
                    console.log("Close button clicked");
                    galleryContainer.classList.add("fade-out");
                    setTimeout(() => {
                        galleryContainer.remove();
                        console.log("Gallery closed via fade-out");
                    }, 500);
                });

                galleryScroll.addEventListener("touchend", () => {
                    isSwiping = false;
                    console.log("Touch end detected, swipe state reset");
                });
            }
        });

        // Add CSS for the popup gallery
        const style = document.createElement("style");
        style.textContent = `
            .gallery-popup {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            }

            .gallery-content {
                position: relative;
                max-width: 90%;
                max-height: 90%;
                text-align: center;
                overflow: hidden;
            }

            .gallery-scroll {
                display: flex;
                transition: transform 0.5s ease;
                scrollbar-width: none; /* Hide scrollbar for Firefox */
            }

            .gallery-scroll::-webkit-scrollbar {
                display: none; /* Hide scrollbar for Chrome, Safari, and Opera */
            }

            .gallery-slide {
                flex: 0 0 100%; /* Each slide takes full width */
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }

            .gallery-slide img {
                max-width: 100%;
                max-height: 80vh;
                border-radius: 8px;
            }

            .gallery-subtext {
                color: white;
                margin-top: 10px;
            }

            .gallery-close {
                position: absolute;
                top: 10px;
                right: 20px;
                font-size: 30px;
                color: white;
                cursor: pointer;
                z-index: 10001; /* Ensure the close button is above other elements */
            }

            .gallery-prev,
            .gallery-next {
                position: absolute;
                top: 50%;
                transform: translateY(-50%);
                background-color: rgba(255, 255, 255, 0.5);
                border: none;
                font-size: 24px;
                cursor: pointer;
                z-index: 10001;
            }

            .gallery-prev {
                left: 10px;
            }

            .gallery-next {
                right: 10px;
            }
        `;
        document.head.appendChild(style);
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Hamburger Menu Toggle
            const menuIcon = document.querySelector(".menu-icon");
            const menu = document.querySelector(".menu");

            menuIcon.addEventListener("click", () => {
                menu.classList.toggle("active");
            });

            // Close menu when clicking a link (for mobile)
            document.querySelectorAll("nav .menu a").forEach((link) => {
                link.addEventListener("click", () => {
                    if (menu.classList.contains("active")) {
                        menu.classList.remove("active");
                    }
                });
            });

            // Smooth Scroll
            document.querySelectorAll("nav .menu a, .logo a").forEach((anchor) => {
                anchor.addEventListener("click", function (e) {
                    e.preventDefault();

                    const targetId = this.getAttribute("href").substring(1);

                    if (targetId === "" || targetId === "home") {
                        // Scroll to the top if "Home" or the logo is clicked
                        window.scrollTo({
                            top: 0,
                            behavior: "smooth",
                        });
                    } else {
                        // Calculate the offset for other sections
                        const targetSection = document.getElementById(targetId);
                        const offset = 70; // Adjust this value to set the space above the section
                        const elementPosition =
                            targetSection.getBoundingClientRect().top +
                            window.scrollY -
                            offset;

                        window.scrollTo({
                            top: elementPosition,
                            behavior: "smooth",
                        });
                    }
                });
            });
        });

        document.addEventListener("DOMContentLoaded", () => {
            const cookieConsentBar = document.getElementById("cookie-consent-bar");
            const acceptCookiesButton = document.getElementById("accept-cookies");

            // Check if the user has already accepted cookies
            if (!localStorage.getItem("cookiesAccepted")) {
                cookieConsentBar.style.display = "flex"; // Show the consent bar
            }

            // Handle accept button click
            acceptCookiesButton.addEventListener("click", () => {
                localStorage.setItem("cookiesAccepted", "true"); // Store the acceptance in local storage
                cookieConsentBar.style.display = "none"; // Hide the consent bar
            });
        });

        document
            .getElementById("contact-form")
            .addEventListener("submit", function (e) {
                e.preventDefault(); // Prevent default form submission

                const form = e.target;
                const data = new FormData(form);
                const action = form.action;

                fetch(action, {
                    method: "POST",
                    body: data,
                    headers: {
                        Accept: "application/json",
                    },
                })
                    .then((response) => {
                        if (response.ok) {
                            form.reset();
                            document.getElementById("success-message").style.display =
                                "block";
                        } else {
                            alert(
                                "Une erreur s'est produite. Veuillez réessayer plus tard."
                            );
                        }
                    })
                    .catch((error) => {
                        alert("Une erreur s'est produite. Veuillez réessayer plus tard.");
                    });
            });
    </script>

    <!-- Cookie Consent Bar -->
    <div id="cookie-consent-bar" class="cookie-consent-bar">
        <p>
            Ce site utilise des cookies pour vous offrir une meilleure expérience
            utilisateur. En utilisant notre site, vous acceptez l'utilisation de
            cookies.
            <button id="accept-cookies" class="cookie-consent-button">
                Accepter
            </button>
        </p>
    </div>
</body>

</html>